import driveboard, time
import sys

# build up connection
driveboard.connect()

# print driveboard.status()
#
# driveboard.jobfile("../library/lines.dba")
# while not driveboard.status()['ready']:
#     time.sleep(1)
#     print str(driveboard.status()['progress']*100) + '%'
#     sys.stdout.write('.')

print driveboard.status()

path = [[[0, 0], [0, 0]],
 [[118.032, 8.486],
  [116.43, 8.641],
  [113.708, 9.719],
  [111.841, 11.177],
  [110.933, 12.172],
  [110.096, 13.547],
  [108.931, 17.198],
  [108.037, 21.231],
  [106.926, 24.67],
  [106.135, 25.86],
  [105.149, 26.732],
  [102.655, 27.988],
  [99.453, 28.569],
  [95.53, 28.449],
  [93.294, 28.118],
  [90.879, 27.483],
  [86.222, 25.661],
  [85.467, 25.366],
  [80.772, 23.645],
  [79.135, 23.046],
  [74.252, 21.969],
  [73.681, 21.844],
  [69.668, 21.561],
  [67.541, 21.627],
  [62.766, 22.113],
  [57.858, 23.067],
  [53.483, 23.919],
  [48.688, 25.338],
  [44.971, 26.439],
  [40.298, 28.217],
  [37.725, 29.197],
  [34.733, 30.517],
  [30.229, 32.688],
  [28.852, 33.352],
  [24.507, 35.827],
  [20.163, 38.302],
  [19.712, 38.56],
  [15.715, 41.564],
  [14.43, 42.53],
  [12.296, 44.628],
  [11.383, 45.754],
  [9.943, 48.18],
  [8.714, 51.874],
  [8.486, 54.082],
  [8.688, 56.113],
  [9.945, 59.827],
  [11.6, 62.562],
  [12.719, 63.96],
  [13.743, 65.031],
  [16.357, 67.172],
  [19.675, 69.148],
  [23.638, 70.76],
  [25.843, 71.368],
  [27.959, 71.799],
  [31.404, 72.127],
  [35.447, 71.541],
  [38.049, 70.636],
  [39.97, 69.735],
  [43.57, 67.249],
  [44.875, 65.953],
  [46.066, 64.18],
  [46.77, 61.805],
  [46.868, 61.411],
  [47.322, 62.24],
  [48.164, 63.212],
  [49.834, 63.566],
  [51.666, 63.537],
  [53.466, 63.521],
  [54.065, 63.528],
  [53.944, 62.647],
  [52.884, 61.53],
  [52.089, 60.573],
  [51.869, 59.653],
  [51.851, 55.721],
  [51.948, 53.094],
  [52.243, 51.178],
  [53.024, 49.244],
  [53.183, 49.037],
  [58.182, 49.103],
  [58.51, 49.108],
  [63.507, 48.953],
  [66.483, 48.861],
  [71.446, 48.254],
  [74.636, 47.865],
  [79.598, 47.251],
  [80.276, 47.168],
  [80.737, 47.218],
  [81.638, 47.936],
  [82.909, 50.16],
  [84.545, 54.884],
  [84.969, 56.107],
  [85.815, 58.88],
  [86.862, 62.082],
  [87.455, 63.431],
  [89.769, 63.672],
  [93.012, 63.581],
  [92.843, 62.728],
  [91.712, 61.589],
  [91.107, 60.855],
  [90.985, 59.882],
  [91.048, 55.122],
  [91.318, 52.318],
  [91.901, 48.938],
  [92.448, 46.235],
  [92.827, 45.609],
  [93.082, 45.545],
  [94.361, 45.346],
  [98.39, 44.352],
  [101.196, 43.358],
  [103.8, 42.129],
  [107.88471556717619, 39.245],
  [108.374, 38.9],
  [111.847, 35.303],
  [111.947, 35.201],
  [114.334, 31.701],
  [115.025, 30.234],
  [115.79, 27.993],
  [116.497, 24.354],
  [116.206, 20.223],
  [115.66, 17.746],
  [115.693, 17.212],
  [116.604, 16.748],
  [118.214, 16.583],
  [120.007, 16.106],
  [120.81, 15.559],
  [121.058, 15.262],
  [121.181, 15.056],
  [120.805, 14.598],
  [118.472, 13.765],
  [117.918, 13.618],
  [119.505, 13.773],
  [121.833, 13.689],
  [122.704, 12.219],
  [123.139, 10.69],
  [121.964, 9.565],
  [119.745, 8.637],
  [118.412, 8.503],
  [118.225, 8.492],
  [118.032, 8.486]],
 [[118.976, 9.632],
  [119.325, 9.787],
  [119.47, 10.161],
  [119.325, 10.536],
  [118.976, 10.691],
  [118.627, 10.536],
  [118.482, 10.161],
  [118.627, 9.787],
  [118.976, 9.632]],
 [[35.526, 44.716],
  [36.571, 44.748],
  [37.414, 44.91],
  [38.807, 45.408],
  [40.756, 46.527],
  [42.465, 49.085],
  [43.482, 51.824],
  [45.087, 56.339],
  [45.272, 57.575],
  [44.3, 56.875],
  [42.504, 56.04],
  [40.915, 55.868],
  [39.54, 56.251],
  [37.896, 57.634],
  [36.527, 60.425],
  [36.214, 61.984],
  [37.222, 60.846],
  [38.97, 59.222],
  [40.574, 58.696],
  [42.29, 59.546],
  [43.27, 60.573],
  [43.685, 61.341],
  [43.482, 63.038],
  [42.2, 64.836],
  [40.197, 66.596],
  [39.037, 67.417],
  [37.619, 68.303],
  [34.944, 69.605],
  [32.437, 70.287],
  [30.046, 70.359],
  [28.877, 70.169],
  [26.95, 69.528],
  [23.078, 67.172],
  [19.726, 63.835],
  [17.543, 60.058],
  [17.094, 58.174],
  [16.984, 56.757],
  [17.139, 54.364],
  [17.985, 52.341],
  [19.749, 50.426],
  [21.045, 49.426],
  [22.389, 48.595],
  [25.913, 46.995],
  [29.97, 45.671],
  [33.861, 44.858],
  [35.526, 44.716]]]

count = 0
# if driveboard.status()['ready']:
driveboard.intensity(0.0)
driveboard.air_on()
seekrate_ = 6000
feedrate_ = 2000
intensity_ = 100.0
driveboard.absolute()
for polyline in path:
    if len(polyline) > 0:
        driveboard.feedrate(seekrate_)
        driveboard.intensity(0.0)
        driveboard.move(polyline[0][0], polyline[0][1])
        if len(polyline) > 1:
            driveboard.feedrate(feedrate_)
            driveboard.intensity(intensity_)
            for i in range(1, len(polyline)):
                driveboard.move(polyline[i][0], polyline[i][1])
                count += 1
                time.sleep(0.08)

driveboard.air_off()
driveboard.feedrate(seekrate_)
driveboard.intensity(0.0)
time.sleep(0.1)
driveboard.move(0, 0, 0)
time.sleep(0.1)
print("Count: {}".format(count))

driveboard.close()
